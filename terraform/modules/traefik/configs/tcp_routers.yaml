tcp:
  routers:
    # K8s services are listed explicitly here (priority 100).
    # Everything else falls through to komodo-tcp-router (catch-all).
    # When adding a new K8s-served domain, add it here.
    # When adding a new Komodo-served domain, no change needed here.
    k8s-tcp-router:
      entryPoints:
        - websecure
      rule: >-
        HostSNI(`argocd.ravil.space`)
        || HostSNI(`glance.ravil.space`)
        || HostSNI(`dozzle.k8s.ravil.space`)
        || HostSNI(`it-tools.ravil.space`)
        || HostSNI(`inbox-zero.ravil.space`)
        || HostSNI(`changedetection.ravil.space`)
        || HostSNI(`grafana.ravil.space`)
        || HostSNI(`ha.ravil.space`)
        || HostSNI(`openwebui.ravil.space`)
        || HostSNI(`pocketid.ravil.space`)
        || HostSNI(`proxmox.ravil.space`)
      service: k8s-tcp-service
      priority: 100
      tls:
        passthrough: true

    komodo-tcp-router:
      entryPoints:
        - websecure
      rule: 'HostSNI("*")'
      service: komodo-tcp-service
      priority: 50
      tls:
        passthrough: true

  services:
    komodo-tcp-service:
      loadBalancer:
        servers:
          - address: "192.168.1.166:443"

    k8s-tcp-service:
      loadBalancer:
        servers:
          - address: "192.168.1.222:443"
